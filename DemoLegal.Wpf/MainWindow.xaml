<Window x:Class="DemoLegal.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="DemoLegal — Взыскание долгов ЖКХ (MVP)"
        Height="480" Width="820" WindowStartupLocation="CenterScreen">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="DemoLegal (MVP)" FontSize="20" FontWeight="Bold" Margin="0,0,0,8"/>
        <TextBlock Grid.Row="1" Text="Шаг 1: Импорт отчёта (.csv или .xlsx) и подготовка дел" Margin="0,0,0,8"/>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,8">
            <Button x:Name="BtnImport" Content="Импорт CSV/XLSX" Width="220" Height="36" Click="ImportButton_Click"/>
            <TextBlock Text="   Кол-во строк:" VerticalAlignment="Center" Margin="12,0,4,0"/>
            <TextBox x:Name="RowLimitBox" Width="90" VerticalAlignment="Center" 
                     ToolTip="Оставьте пустым — загрузятся все строки"/>
            <TextBlock Text="(пусто = все)" VerticalAlignment="Center" Margin="6,0,0,0" Opacity="0.7"/>
            <Button x:Name="BtnCandidates" Content="Реестр кандидатов" Width="220" Height="36" Margin="12,0,0,0" Click="OpenCandidates_Click"/>
            <Button x:Name="BtnSaveReport" Content="Скачать отчёт" Width="160" Height="36" Margin="12,0,0,0" Click="SaveReport_Click" IsEnabled="False"/>
        </StackPanel>

        <Border Grid.Row="3" BorderBrush="#DDD" BorderThickness="1" Padding="8" CornerRadius="4">
            <StackPanel>
                <TextBlock Text="Статус" FontWeight="Bold" Margin="0,0,0,4"/>
                <StackPanel Orientation="Horizontal">
                    <ProgressBar x:Name="BusyBar" Width="260" Height="16" IsIndeterminate="True" Visibility="Collapsed"/>
                    <TextBlock x:Name="StatusText" Text="Готово." Margin="8,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>
                <TextBlock Text="Подсказка: отчёт импорта появляется после завершения и доступен по кнопке «Скачать отчёт»." Opacity="0.7" Margin="0,8,0,0"/>
            </StackPanel>
        </Border>

        <TextBlock Grid.Row="4" Text="Далее: генерация пакетов документов, расчёт пеней, ФССП" Opacity="0.7" Margin="0,8,0,0"/>
    </Grid>
</Window>
